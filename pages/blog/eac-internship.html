<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="darkreader-lock">
    <link rel="stylesheet" href="../../assets/libraries/bootstrap5.0.2/bootstrap.min.css">
    <link rel="stylesheet" href="../../assets/libraries/fontawesome6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
    
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/github-markdown-dark.css">
    <script src="../../assets/js/common.js"></script>
    <title>Internship at the European Space Agency</title>
	
	<link rel="apple-touch-icon" sizes="180x180" href="../../assets/img/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../assets/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../assets/img/favicon/favicon-16x16.png">
<link rel="manifest" href="../../assets/img/favicon/site.webmanifest">
<link rel="mask-icon" href="../../assets/img/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../../assets/img/favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#941739">
<meta name="msapplication-config" content="../../assets/img/favicon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
</head>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-5RWJF4E3GR"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5RWJF4E3GR');
</script>

<body>
<div id="HTMLdata"
section="blog">
</div>
<div style="display: flex; flex-direction: column; height: 100vh; width: 100vw; overflow-x: hidden; background-color: rgb(35, 39, 50);">
	<div id="HTMLtopbar" style="flex: 0;"><div class="row" style="display: flex;" id="linksTopbar">
    <div style="flex: 6; display: flex; align-items: center; background-color: rgb(14, 60, 76); color: white; height: 100%;">
        &emsp;<a href="../../pages/about.html" style="text-decoration: none; color: white;" title="Who am I?">Arbelo Cabrera, Pablo</a>
        &emsp;<a class="linkPopUp" href="https://www.youtube.com/@pactomars"><i class="fa-brands fa-youtube fa-lg" title="YouTube channel" style="color: rgb(255, 129, 129)"></i></a>
        &emsp;<a class="linkPopUp" href="https://www.flickr.com/photos/200282744@N03/albums" title="flickr albums"><img height="45em" src="../../assets/img/icons/flickr.svg" alt="flickr official logo."></a>
        &emsp;<a class="linkPopUp" href="https://www.linkedin.com/in/pablo-arbelo-cabrera-051a951a2"><i class="fa-brands fa-linkedin-in fa-lg" title="LinkedIn profile" style="color: rgb(90, 176, 247)"></i></a>
        &emsp;<a class="linkPopUp" href="https://github.com/sp-droid"><i class="fa-brands fa-github fa-lg" title="GitHub profile" style="color: rgb(230, 237, 243)"></i></a>
    </div>
    <div style="flex: 1; display: flex; align-items: center; justify-content: center; background-color: rgb(76, 57, 2); height: 100%;">
        <a class="linkPopUp" title="For work or other topics" href="https://docs.google.com/forms/d/1pK5hPSywf1resOSLIUOESFpqQn6cnRa2YjkRF7d77D8" style="font-weight: 500; color: rgb(222, 237, 240)">Contact</a>
    </div>
</div>
<div class="row" id="navTopbar" style="background: linear-gradient(to right, rgb(48, 40, 2), rgb(35, 38, 39))">
    <div class="col d-flex align-items-center justify-content-center" style="line-height: 20px; height: 100%;">
        <!-- <a id="indexMenuButton" href="../../pages/index.html" title="Homepage where recent or current projects/entries/news are showcased">Home</a> -->
        <a id="projectsMenuButton" href="../../pages/projects.html" title="Projects of different kinds are highlighted, sometimes as a video, as a JS browser-app or as an entire webpage">Projects</a>
        <a id="recipesMenuButton" href="../../pages/recipes.html" title="Some of my recipes since I like cooking quite a bit">Recipes</a>
        <a id="blogMenuButton" href="../../pages/blog.html" title="Devlogs and personal notes">Blog</a>
        <a id="aboutMenuButton" href="../../pages/about.html" title="Brief page about myself for anyone interested">About me</a>
    </div>
</div></div>
    <div style="flex: 1; display: flex;">
        <div class="markdown-body sidebarHide" style="flex: 1; min-width: 20px;"><br><div class='TOCpost'><h3>&nbsp;Contents</h3><ul><li><a href='#section0'>(Top)</a></li><ul><li><a href='#section1'>Mineral Spectra ML Classifier</a></li><li><a href='#section2'>Data Portal Proof of Concept</a></li><li><a href='#section3'>Human Aspect</a></li></ul>
</ul></div></div>
        <div class="markdown-body" id="HTMLpost"><div id="section0"></div>
<h6>February 15th, 2025</h6>
<h1>Internship at the European Space Agency</h1>
<h5>Reading time: 6 mins</h5>
<hr>
<p>My ESA internship took place during 2023 at the European Astronaut Centre (Cologne, Germany), as ML and software engineer for the CAVES &amp; Pangaea group. Concretely, I contributed to Pangaea internal development projects under the mentorship of Igor Drozdovsky. Pangaea is a course for the training of astronauts in geology focused on extraterrestrial analog environments, taking them (as of 2023) to 4 locations with different geologic characteristics: Lofoten (Norway), Ries crater (Germany), Bletterbach (Dolomites, Italy) and the island of Lanzarote (Spain). I come from Lanzarote by the way, did that play a part in the selection!?</p>
<img src="https://www.esa.int/var/esa/storage/images/esa_multimedia/images/2019/01/lunar_setting/19205792-1-eng-GB/Lunar_setting_pillars.jpg" alt="Lanzarote is of geologic interest due to its recent volcanic activity. Source@esa.int" style="zoom:50%;" />
<p>As this is work, I won't share any concrete details.</p>
<p><div class='TOCpost'><h3>&nbsp;Contents</h3><ul><li><a href='#section0'>(Top)</a></li><ul><li><a href='#section1'>Mineral Spectra ML Classifier</a></li><li><a href='#section2'>Data Portal Proof of Concept</a></li><li><a href='#section3'>Human Aspect</a></li></ul>
</ul></div></p>
<div id="section1"></div>
<h2>Mineral Spectra ML Classifier</h2>
<p>Among other tasks, Igor manages a fluctuating group of interns that research and develop mineral/element recognition tools for the field trips. I arrived in July and the annual Pangaea tour was going to take place in September, when they would visit Lanzarote. My immediate goal was to design and train an ML classifier that would be executed on a device called EFB when an astronaut picked up a rock and used the handheld VNIR spectrometer on it.</p>
<img src="https://m.media-amazon.com/images/I/5157F1MUymL.jpg" alt="VNIR spectrometer's example output. Source@amazon.com" style="zoom: 25%;" />
<p>Quite a few interns had attacked the same problem before. Models were built and specialized for the equipment at hand (spectrometer quality, spectral bands, measurement type), collected data and geological region of interest. Talking about the specific architecture I ended up going for is off-reach, but the type was a 2D-CNN. After many hours tweaking the architecture,  hyperparameters tuning, data pre-processing (including manually removing outliers for 5000 spectra in about 60 classes...), validation...</p>
<img src="../../content/blog/assets/esa-internship-classImbalance.jpg" alt="One of the main challenges: class imbalance. Every column represents #samples per class." style="zoom: 50%;" />
<p>The result was an adequately sized model that was, in their own words, &quot;the best one to date&quot;! The following is an extract from the final presentation:</p>
<ul>
<li>Runs <strong>fast on the EFB</strong></li>
<li><strong>Performs well on the validation set</strong> globally and in most classes</li>
<li>Supports <strong>many more mineral species</strong> than before</li>
<li>And <strong>performed well in the real world</strong></li>
</ul>
<p>I wouldn't attribute the success to any part alone, though for sure the most painful one was removing outliers. The data was shaped in a way that made very difficult either ignoring them or automatically detecting them, due to their high proportion, high number of classes... So I decided to brute-force it, manually learning how the spectra of a certain class looked, aided by class average / median / percentile plots. This work is very specific for the spectrometer's spectral range so the outliers will need to be re-evaluated once they change it.</p>
<div id="section2"></div>
<h2>Data Portal Proof of Concept</h2>
<p>After the mission in September, I could choose the next topic I would work on for the remaining half of the internship. Of the several I was given, I got curious about the idea of developing a Data Portal PoC for the team:</p>
<ul>
<li>Our data repository lacked spectra on many minerals and elements. This would give geologists outside ESA an easier way to donate their data and help us fill those gaps.</li>
<li>As per ESA policy, it wasn't possible to share field trip spectra, models and other proprietary information, except data obtained externally. The platform could additionally bridge different data collections.</li>
<li>There wasn't anything similar in capabilities and reach.</li>
<li>We couldn't share them, but we could offer in-browser usage of our models.</li>
<li>In-browser model training based on available data</li>
<li>Statistical analysis of results</li>
</ul>
<img src="../../content/blog/assets/esa-internship-dataportal.jpg" alt="Pitched idea for a proposed, more advanced section of the portal." style="zoom: 80%;" />
<p>There were challenges:</p>
<ul>
<li>We would need permission for an ESA hosting license.</li>
<li>There were many issues regarding ESA policy, expectations and different views in the team on how or even if to tackle the problem.</li>
<li>The team had setup data and model training separately, and they had never been used together in an automatic way, or designed for a consistent output. Model saving had to be standardized and many functions end points had to be tweaked. Data portal aside, these developments were deemed quite positive for the future consistency and interoperability of everything.</li>
<li>Time constraint: concept design, preliminary requirements definition, a proof of concept and tying everything up for next interns or future progress, in 3 months.</li>
</ul>
<p>In the end, the idea was brought to life and presented with very positive reception. However, the interns profile not focusing on web development coupled with the ephemeral nature of the internships themselves means any meaningful progress on the idea will take at least a year for it to even begin. Time will tell, but certainly I am very satisfied with both ends of my work there.</p>
<div id="section3"></div>
<h2>Human Aspect</h2>
<p>In the personal domain, I grew substantially during my stay in Cologne. More than a year has passed since I left, and I've had time to reflect on this experience. It wasn't always perfect, but it was extraordinary to be there. It's difficult to pinpoint the exact reason, I don't know yet. What I can say though, is that I've been living out of my home since I was 17, in different cities and countries, and only after this experience and some time to process it, I'm ready to face whatever is in front of me. It wasn't me just feeling well; I have very fond memories of my time in high school in Lanzarote, and during the first years of my bachelors in Madrid; it was also feeling the world was smaller. I guess that's how I can describe it now.</p>
<p>With respect to my most immediate colleagues, they received me well when I first arrived, but with the exception of Verena (YGT), all of them were leaving less than 2 months into my own stay, and the team was fairly small. After this I suddenly became the <em>veteran</em> (ðŸ˜Ž) and new interns swelled up our ranks. I tried my best to help them throughout, and soon I found them making things better for me in different ways. Each and every one of them were so funny and unique. The atmosphere was really good and I'll probably chase that kind of work relationship forever. All of them were great people, I can attest for Igor being good at finding character and integrity.</p>
<p>There's more to it than this, but it's not right for this post.</p>
<p>Working for ESA was incredible and I'd love to repeat it. Aside from internships it could be also interesting for the young reader to check post-graduate programs such as the <a href="https://www.esa.int/About_Us/Careers_at_ESA/Graduates_ESA_Graduate_Trainees">EGT (used to be YGT)</a> or the lesser known <a href="https://www.esa.int/About_Us/Careers_at_ESA/Junior_Professional_Programme">JPP</a>. Thank you for reading!</p>
<img src="https://www.esa.int/var/esa/storage/images/esa_multimedia/images/2022/01/esa_graduate_trainee_programme/23903523-3-eng-GB/ESA_Graduate_Trainee_Programme_article.png" alt="EGT 2025 call. Source@esa.int"  />
<hr><div class="blogTags"><button class="blogTagSelected" title='Check more posts of the "Projects" category on my blog!'>Projects</button></div><br></div>
        <div style="flex: 1; min-width: 20px;"></div>
    </div>
</div>
<script>
// Table of contents fix for correct opening and closing of detail-summary blocks
function toggleDetails(event) {
    if (event.offsetX < 0) {
        event.stopPropagation();
        const details = event.currentTarget.firstChild;
        details.open = !details.open;
    } else if (event.offsetY < 30) {
        event.stopPropagation();
        const details = event.currentTarget.firstChild;
        details.open = true;
    }
}
// Add figure number and caption to all images
window.onload = function() {   
    const images = document.querySelectorAll("#HTMLpost img");
    let figureNumber = 0;
    images.forEach(img => {
        if (img.alt === "INLINE") { return; }

        figureNumber++;

        img.style.display = "block";
        img.style.margin = "auto";

        const caption = document.createElement("p");
        caption.textContent = `Figure ${figureNumber}. ${img.alt}`;
        caption.style.textAlign = "center";
        caption.style.fontSize = "0.9em"
        img.parentNode.insertBefore(caption, img.nextSibling);        
    });
};
</script>
</body>
</html>